{"mappings":"AAAO,MCGDA,EAASC,SAASC,cAAc,aAChCC,EAAOF,SAASC,cAAc,QAE9BE,IAAmBJ,EAAOK,WAGhC,GAAID,EAAgB,CAClB,MAAME,EAAMN,EAAOK,WAAW,MAC9B,IAAIE,EAAqB,EAEzBP,EAAOQ,MAAQC,OAAOC,WACtBV,EAAOW,OAASF,OAAOG,YAEvBH,OAAOI,SAAW,KAChBb,EAAOQ,MAAQC,OAAOC,WACtBV,EAAOW,OAASF,OAAOG,WAAW,EAIpC,MAAME,EAAW,SAAUC,GACzB,MAAO,4GAAgBA,EAAQ,GAAK,MAAMA,IAAU,KAAKA,UAC3D,EAEMC,EAAc,SAAUD,GAC5B,MAAME,EAAM,IAAIC,MAChBD,EAAIE,IAAML,EAASC,GACnB,IAAIK,EAAoC,KAAhBpB,EAAQQ,MAAgB,KAC5Ca,EAAUrB,EAAOW,OAAS,EAAIS,EAAoB,EAEtDd,EAAIgB,UAAUL,EAAK,EAAGI,EAASrB,EAAOQ,MAAOY,EAC/C,EAGMG,EAAe,IAAIC,MA7BR,IA6B0BC,KAAK,GAAGC,KAAI,CAACC,EAAGC,KACzD,MAAMC,EAASf,EAASc,EAAI,GAC5B,ODtCmCE,ECsCdD,EDrChB,IAAIE,SAAQ,SAAUC,GAC3B,MAAMf,EAAM,IAAIC,MAChBD,EAAIE,IAAMW,EACVb,EAAIgB,iBAAiB,QAAQ,IAAMD,KACrC,IAL2B,IAAUF,CCsCd,IAIvBC,QAAQG,IAAIX,GAAcY,MAAK,WAG7BnB,EAAY,GAEZP,OAAOwB,iBAAiB,UAAU,SAAUG,GAC1C,MAEMC,EAFiBlC,EAAKmC,WACTnC,EAAKoC,aAAepC,EAAKqC,cACW,IACjDC,EAAeC,KAAKC,MAAMN,EAAkB,IA5CrC,IA8Cb9B,EAAqBkC,EAErBG,uBAAsB,IAAM5B,EAAYyB,IAC1C,IAOiB,IAAII,kBAAiB,SAAUC,EAAMC,GACpDD,EAAKE,SAASC,IACe,UAAvBA,EAAKC,eAAoD,WAAvBD,EAAKC,eACzClC,EAAYT,EAAA,GAGlB,IAES4C,QAAQnD,EAAQ,CAAEoD,YAAY,GACzC,GACF","sources":["src/js/utils.js","src/js/index.js"],"sourcesContent":["export const preloadAssets = function (asset) {\r\n  return new Promise(function (resolve) {\r\n    const img = new Image();\r\n    img.src = asset;\r\n    img.addEventListener(\"load\", () => resolve());\r\n  });\r\n};\r\n","import { preloadAssets } from \"./utils.js\";\r\nimport { imgBaseUrl } from \"./data.js\";\r\n\r\nconst canvas = document.querySelector(\".flipbook\");\r\nconst html = document.querySelector(\"html\");\r\n\r\nconst supportsCanvas = !!canvas.getContext;\r\nconst frameCount = 95;\r\n\r\nif (supportsCanvas) {\r\n  const ctx = canvas.getContext(\"2d\");\r\n  let cachedCurrentFrame = 1;\r\n\r\n  canvas.width = window.innerWidth;\r\n  canvas.height = window.innerHeight;\r\n\r\n  window.onresize = () => {\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n  };\r\n\r\n  //returns the img url\r\n  const getFrame = function (index) {\r\n    return `${imgBaseUrl}${index < 10 ? `000${index}` : `00${index}`}.webp`;\r\n  };\r\n\r\n  const updateFrame = function (index) {\r\n    const img = new Image();\r\n    img.src = getFrame(index);\r\n    let aspectRatioHeight = (canvas.width * 1080) / 1920;\r\n    let imgPosY = canvas.height / 2 - aspectRatioHeight / 2;\r\n\r\n    ctx.drawImage(img, 0, imgPosY, canvas.width, aspectRatioHeight);\r\n  };\r\n\r\n  //preload images: returns a list of promises\r\n  const promisedImgs = new Array(frameCount).fill(0).map((_, i) => {\r\n    const imgUrl = getFrame(i + 1);\r\n    return preloadAssets(imgUrl);\r\n  });\r\n\r\n  //checks if all the promises are fulfilled (all images loaded).\r\n  Promise.all(promisedImgs).then(function () {\r\n    //\r\n    //draws the first frame to the canvas\r\n    updateFrame(1);\r\n\r\n    window.addEventListener(\"scroll\", function (e) {\r\n      const currentScrollY = html.scrollTop;\r\n      const maxScrollY = html.scrollHeight - html.clientHeight;\r\n      const scrollProgress = (currentScrollY / maxScrollY) * 100;\r\n      const currentFrame = Math.floor((scrollProgress / 100) * frameCount);\r\n\r\n      cachedCurrentFrame = currentFrame;\r\n\r\n      requestAnimationFrame(() => updateFrame(currentFrame));\r\n    });\r\n\r\n    //NOT REALLY NECESSARY: JUST FOR RESPONSIVENESS\r\n\r\n    //using this api wasn't really necessary. there is an easier way to solve this, just wanted to see how it works, lol\r\n    //\r\n    //checks if the canvas's size changed and redraws the current frame\r\n    const observer = new MutationObserver(function (list, observer) {\r\n      list.forEach((item) => {\r\n        if (item.attributeName === \"width\" || item.attributeName === \"height\") {\r\n          updateFrame(cachedCurrentFrame);\r\n        }\r\n      });\r\n    });\r\n\r\n    observer.observe(canvas, { attributes: true });\r\n  });\r\n}\r\n"],"names":["$8f6a480bb40b134f$var$canvas","document","querySelector","$8f6a480bb40b134f$var$html","$8f6a480bb40b134f$var$supportsCanvas","getContext","ctx","cachedCurrentFrame","width","window","innerWidth","height","innerHeight","onresize","getFrame","index","updateFrame","img","Image","src","aspectRatioHeight","imgPosY","drawImage","promisedImgs","Array","fill","map","_","i","imgUrl","asset","Promise","resolve","addEventListener","all","then","e","scrollProgress","scrollTop","scrollHeight","clientHeight","currentFrame","Math","floor","requestAnimationFrame","MutationObserver","list","observer","forEach","item","attributeName","observe","attributes"],"version":3,"file":"index.6a7637b5.js.map"}